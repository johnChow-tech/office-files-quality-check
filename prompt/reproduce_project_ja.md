# プロジェクト再現のための開発プロンプト：Officeファイル品質チェックツール

## 目的

このプロンプトは、PythonベースのOfficeファイル品質チェックツールの開発環境を再現し、その機能を理解・拡張するためのものです。既存のプロジェクト構造とコーディング規約に従い、主要な機能（Officeドキュメントからのテキスト・ハイパーリンク抽出、URLの一括展開）を実装します。

## プロジェクト概要と主要技術

*   **プロジェクト名:** Officeファイル品質チェックツール
*   **目的:** `.docx`、`.xlsx`、`.xlsm`、`.pptx` などのOfficeドキュメントからコンテンツ（テキスト、ハイパーリンク）を抽出し、管理するためのPython GUIアプリケーション。
*   **言語:** Python
*   **GUIフレームワーク:** Tkinter
*   **ドキュメント解析ライブラリ:** `python-docx`, `openpyxl`, `python-pptx`
*   **その他の主要ライブラリ:** `csv`, `os`, `sys`, `threading`, `webbrowser`, `datetime`
*   **ビルド・実行ツール:** PyInstaller (gui.spec ファイルが存在することから推測)

## 開発環境のセットアップ

1.  **Python環境の準備:**
    *   Python 3.x がインストールされていることを確認してください。
    *   推奨される仮想環境をセットアップします（例: `python -m venv .venv`）。
    *   仮想環境をアクティブ化します。
        *   Windows: `.venv\Scripts\activate`
        *   macOS/Linux: `source .venv/bin/activate`

2.  **依存関係のインストール:**
    *   提供されている `requirements.txt` を使用して、必要なすべてのPythonパッケージをインストールします。
    ```bash
    pip install -r requirements.txt
    ```

## プロジェクト構造とアーキテクチャの理解

プロジェクトは、以下の主要なコンポーネントで構成されています。

*   `gui.py`: メインのGUIアプリケーションエントリポイント。ユーザーインターフェースの構築、イベント処理、進捗表示を担当します。
*   `core/`: コアビジネスロジックを含むディレクトリ。
    *   `core/extractor.py`: Officeファイルからテキストとハイパーリンクを抽出するロジックを実装します。各ファイルタイプ（docx, xlsx, pptx）に対応する抽出処理が含まれます。
    *   `core/url_opener.py`: 抽出されたハイパーリンクを格納するCSVファイルを読み込み、重複排除を行い、ウェブブラウザで一括で開く機能を提供します。URLを開く前に、処理の概要を示す情報HTMLページを生成します。
*   `requirements.txt`: プロジェクトの依存関係リスト。
*   `gui.spec`: PyInstallerを使用して実行可能ファイルをビルドするための設定ファイル。
*   `README.md`, `README.en.md`, `README.zh-CN.md`: プロジェクトのドキュメント（日本語、英語、中国語）。

## 主要機能の実装と確認

以下の手順で各機能を再現し、動作を確認してください。

1.  **GUIアプリケーションの起動:**
    *   仮想環境がアクティブな状態で、メインスクリプトを実行します。
    ```bash
    python gui.py
    ```
    *   GUIウィンドウが表示されることを確認します。

2.  **Officeファイルからのコンテンツ抽出:**
    *   GUIを使用して、入力ディレクトリ（Officeファイルを含む）と出力ディレクトリを指定します。
    *   「抽出開始」ボタンをクリックし、以下の動作を確認します。
        *   選択されたOfficeファイル（.docx, .xlsx, .pptx）からテキストとハイパーリンクが正しく抽出されること。
        *   抽出されたテキストがMarkdownファイル（`PlainText_[元のファイル名]_[元の拡張子].md`）として、タイムスタンプ付きの `PlainText_YYYYMMDDHHMMSS` ディレクトリに出力されること。
        *   抽出されたハイパーリンクがCSVファイル（`Urls_[元のファイル名]_[元の拡張子].csv`）として、タイムスタンプ付きの `HyperLinks_YYYYMMDDHHMMSS` ディレクトリに出力されること。
        *   GUIのプログレスバーとログエリアに進捗が表示され、GUIがフリーズしないこと（非同期処理の確認）。

3.  **URLの一括展開機能の確認:**
    *   抽出されたハイパーリンクCSVファイルが存在する出力ディレクトリを指定します。
    *   「URL展開」ボタンをクリックし、以下の動作を確認します。
        *   CSVファイル内のユニークなURLがすべてウェブブラウザで開かれること。
        *   重複排除ロジックが正しく機能し、各URLが一度だけ開かれること。
        *   URL展開プロセスを開始する前に、概要を示す情報HTMLページが生成され、デフォルトのブラウザで開かれること。

## コーディング規約と品質基準

*   **関心事の分離:** UIロジックとコアロジックは明確に分離されています。
*   **コメントとドキュメント:** コードの意図を説明する詳細なコメント（日本語を優先）と、関数・クラスにはDocstringsを記述してください。
*   **エラーハンドリング:** ファイル操作やデータ処理の際には、`try-except` ブロックを用いて堅牢なエラーハンドリングを実装し、ユーザーにはTkinterの `messagebox` で通知し、詳細はコンソール/ログに出力してください。
*   **非同期処理:** 時間のかかる処理は `threading.Thread` を使用してGUIの応答性を維持してください。
*   **ファイル命名規則:** 抽出ファイルおよび出力ディレクトリの命名規則を遵守してください。

## 拡張の可能性 (オプション)

*   サポートするファイル形式の追加（例: .pdf）。
*   抽出するコンテンツの種類を増やす（例: 画像、テーブル構造）。
*   GUIの改善、設定保存機能の追加。
*   抽出結果のレポート生成機能。

このプロンプトに従って、プロジェクトを再現し、その機能を詳細に分析してください。